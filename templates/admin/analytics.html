{% load i18n %}
{% load staticfiles %}
<script>
(function(w,d,s,g,js,fs){
g=w.gapi||(w.gapi={});g.analytics={q:[],ready:function(f){this.q.push(f);}};
js=d.createElement(s);fs=d.getElementsByTagName(s)[0];
js.src='https://apis.google.com/js/platform.js';
fs.parentNode.insertBefore(js,fs);js.onload=function(){g.load('analytics');};
}(window,document,'script'));
</script>
<!-- Include the ActiveUsers component script. -->
    <script src="{% static 'admin/js/home/active-users.js' %}"></script>
    <script src="{% static 'admin/js/home/view-selector2.js' %}"></script>


<h4 class="italic-title"><span class="btn btn-default" id="active-users-container"></span></h4>
<!-- this is just to make the view selector work, no need to display it -->
<div id="view-selector-container" style="display: none"></div>
 
<div class="row-fluid" style="margin: 20px 0;">
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Tr치fico interno" %}</h3>
<section class="panel">
<h2>{% trans 'Sesiones y usuarios, ultimos 15 dias' %}</h2>
<div id="chart-1-container"></div>
</section>
</div>
</div>
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Popularidad interna" %}</h3>
<section class="panel">
<h2>{% trans 'Visitas, ultimos 15 dias' %}</h2>
<div id="chart-2-container"></div>
</section>
</div>
</div>
</div>
<div class="row-fluid" style="margin: 20px 0;">
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Tr치fico externo" %}</h3>
<section class="panel">
<h2>{% trans 'Sesiones y usuarios, ultimos 15 dias' %}</h2>
<div id="chart-1-container-p"></div>
</section>
</div>
</div>
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Popularidad externa" %}</h3>
<section class="panel">
<h2>{% trans 'Visitas, ultimos 15 dias' %}</h2>
<div id="chart-2-container-p"></div>
</section>
</div>
</div>
</div>
<div class="row-fluid" style="margin: 20px 0;">
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Pais de visitas internas" %}</h3>
<section class="panel">
<h2>{% trans 'Ultimos 15 dias' %}</h2>
<div id="chart-5-container"></div>
</section>
</div>
</div>
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Pais de visitas externas" %}</h3>
<section class="panel">
<h2>{% trans 'Ultimos 15 dias' %}</h2>
<div id="chart-5-container-p"></div>
</section>
</div>
</div>
</div>
<div class="row-fluid" style="margin: 20px 0;">
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Navegadores mas populares" %}</h3>
<section class="panel">
<h2>{% trans 'Ultimos 15 dias' %}</h2>
<div id="chart-3-container"></div>
</section>
</div>
</div>
<div class="c6">
<div class="documents filters intranet box">
<h3 class="setup-subtitle green">{% trans "Adquisici칩n" %}</h3>
<section class="panel">
<h2>{% trans 'Tr치fico referido, ultimos 15 dias' %}</h2>
<div id="chart-4-container"></div>
</section>
</div>
</div>
</div>
 
<script>
 
gapi.analytics.ready(function() {
 
/**
* Authorize the user with an access token obtained server side.
*/
gapi.analytics.auth.authorize({
'serverAuth': {
'access_token': '{{ token }}'
}
});
 
/**
* Create a new ActiveUsers instance to be rendered inside of an
* element with the id "active-users-container" and poll for changes every
* five seconds.
*/
var activeUsers = new gapi.analytics.ext.ActiveUsers({
container: 'active-users-container',
pollingInterval: 5
});
 
/**
* Create a new ViewSelector2 instance to be rendered inside of an
* element with the id "view-selector-container".
*/
var viewSelector = new gapi.analytics.ext.ViewSelector2({
container: 'view-selector-container',
})
.execute();
 
/**
* Update the activeUsers component, the Chartjs charts, and the dashboard
* title whenever the user changes the view.
*/
viewSelector.on('viewChange', function(data) {
// Start tracking active users for this view.
activeUsers.set(data).execute();
});
 
/**
* Creates a new DataChart instance showing sessions over the past 15 days.
*/
var dataChart1 = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:sessions,ga:users',
'filters' : 'ga:country!=Russia',
'dimensions': 'ga:date'
},
chart: {
'container': 'chart-1-container',
'type': 'LINE',
'options': {
'width': '100%'
}
}
});
dataChart1.execute();

var dataChart1P = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id_public }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:sessions,ga:users',
'filters' : 'ga:country!=Russia',
'dimensions': 'ga:date'
},
chart: {
'container': 'chart-1-container-p',
'type': 'LINE',
'options': {
'width': '100%'
}
}
});
dataChart1P.execute();
 
 
/**
* Creates a new DataChart instance showing top 5 most popular pages
*/
var dataChart2 = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:pageviews',
'dimensions': 'ga:pagePathLevel3',
'filters' : 'ga:country!=Russia',
'sort': '-ga:pageviews',
'max-results': 7
},
chart: {
'container': 'chart-2-container',
'type': 'PIE',
'options': {
'width': '100%',
'pieHole': 4/9,
}
}
});
dataChart2.execute();

var dataChart2P = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id_public }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:pageviews',
'dimensions': 'ga:pagePathLevel2',
'filters' : 'ga:country!=Russia',
'sort': '-ga:pageviews',
'max-results': 7
},
chart: {
'container': 'chart-2-container-p',
'type': 'PIE',
'options': {
'width': '100%',
'pieHole': 4/9,
}
}
});
dataChart2P.execute();
 
/**
* Creates a new DataChart instance showing top borwsers
*/
var dataChart3 = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:sessions',
'dimensions': 'ga:browser',
'filters' : 'ga:country!=Russia',
'sort': '-ga:sessions',
'max-results': 7
},
chart: {
'container': 'chart-3-container',
'type': 'PIE',
'options': {
'width': '100%',
'pieHole': 4/9,
}
}
});
dataChart3.execute();
 
/**
* Creates a new DataChart instance showing top referral
*/
var dataChart4 = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:sessions',
'dimensions': 'ga:source',
'filters' : 'ga:country!=Russia',
'sort': '-ga:sessions',
'max-results': 7
},
chart: {
'container': 'chart-4-container',
'type': 'PIE',
'options': {
'width': '100%',
'pieHole': 4/9,
}
}
});
dataChart4.execute();
 
/**
* Creates a new DataChart instance showing top visitors continents
*/
var dataChart5 = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:sessions',
'dimensions': 'ga:country',
'filters' : 'ga:country!=Russia',
'sort': '-ga:sessions',
'max-results': 7
},
chart: {
'container': 'chart-5-container',
'type': 'PIE',
'options': {
'width': '100%',
'pieHole': 4/9,
}
}
});
dataChart5.execute();

var dataChart5p = new gapi.analytics.googleCharts.DataChart({
query: {
'ids': 'ga:{{ view_id_public }}',
'start-date': '15daysAgo',
'end-date': 'today',
'metrics': 'ga:sessions',
'dimensions': 'ga:country',
'filters' : 'ga:country!=Russia',
'sort': '-ga:sessions',
'max-results': 7
},
chart: {
'container': 'chart-5-container-p',
'type': 'PIE',
'options': {
'width': '100%',
'pieHole': 4/9,
}
}
});
dataChart5p.execute();
 
 
});
</script>
 